<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="xBIM Toolkit is an Open Source toolkit for IFC and BIM. You can use it to do anything with IFC. It implements IFC2x3 and IFC4 and allows to develop SW agnostic to IFC version and file format.">
    <meta name="author" content="xBIM Team">
    <link rel="icon" href="../img/favicon.ico">

    <title>xBIM</title>

    <!-- Bootstrap core CSS -->
    <link href="../css/bootstrap.min.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Custom styles for this template -->
    <link href="../css/codestyles.css" rel="stylesheet">
    <link href="../css/site.css" rel="stylesheet">

    <script src="../js/jquery.min.js"></script>

  </head>
<!-- NAVBAR
================================================== -->
  <body>

    <nav class="navbar navbar-inverse">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">xBIM</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          		   
	<ul class="nav navbar-nav">
        <li>
			<a href="../quick-start.html">Quick Start</a>
		</li>
        <li class="dropdown">
			<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Examples <span class="caret"></span></a>
			
	<ul class="dropdown-menu">
        <li>
			<a href="../examples/basic-model-operations.html">Basic Model Operations</a>
		</li>
        <li>
			<a href="../examples/change-log-creation.html">Change Log Creation</a>
		</li>
        <li>
			<a href="../examples/creating-wexbim-file.html">Creating wexBIM file</a>
		</li>
        <li>
			<a href="../examples/federating-models.html">Federating Models</a>
		</li>
        <li>
			<a href="../examples/insert-copy-function.html">Insert Copy Function</a>
		</li>
        <li>
			<a href="../examples/proper-wall-in-3d.html">Proper Wall in 3D</a>
		</li>
    </ul>

		</li>
        <li class="dropdown">
			<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">License <span class="caret"></span></a>
			
	<ul class="dropdown-menu">
        <li>
			<a href="../license/license.html">License</a>
		</li>
        <li>
			<a href="../license/third-party-licenses.html">Third Party Licenses</a>
		</li>
    </ul>

		</li>
        <li class="dropdown">
			<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">xBIM 4 <span class="caret"></span></a>
			
	<ul class="dropdown-menu">
        <li>
			<a href="../xbim-4/fast-upgrade-track.html">Fast Upgrade Track</a>
		</li>
        <li>
			<a href="../xbim-4/xbim-4-release-notes.html">xBIM 4 Release Notes</a>
		</li>
    </ul>

		</li>
    </ul>

        </div><!--/.nav-collapse -->
      </div>
    </nav>

		<div class="container">

<div class="csharp"><pre><code><span class="keyword">using</span> <span class="type">System</span>;
<span class="keyword">using</span> <span class="type">System</span>.Collections.Generic;
<span class="keyword">using</span> <span class="type">System</span>.Diagnostics;
<span class="keyword">using</span> <span class="type">System</span>.Linq;
<span class="keyword">using</span> <span class="type">Xbim</span>.Common;
<span class="keyword">using</span> <span class="type">Xbim</span>.Common.Step21;
<span class="keyword">using</span> <span class="type">Xbim</span>.Ifc;
<span class="keyword">using</span> <span class="type">Xbim</span>.Ifc4.ActorResource;
<span class="keyword">using</span> <span class="type">Xbim</span>.Ifc4.DateTimeResource;
<span class="keyword">using</span> <span class="type">Xbim</span>.Ifc4.ExternalReferenceResource;
<span class="keyword">using</span> <span class="type">Xbim</span>.Ifc4.PresentationOrganizationResource;
<span class="keyword">using</span> <span class="type">Xbim</span>.Ifc4.GeometricConstraintResource;
<span class="keyword">using</span> <span class="type">Xbim</span>.Ifc4.GeometricModelResource;
<span class="keyword">using</span> <span class="type">Xbim</span>.Ifc4.GeometryResource;
<span class="keyword">using</span> <span class="type">Xbim</span>.Ifc4.Interfaces;
<span class="keyword">using</span> <span class="type">Xbim</span>.Ifc4.Kernel;
<span class="keyword">using</span> <span class="type">Xbim</span>.Ifc4.MaterialResource;
<span class="keyword">using</span> <span class="type">Xbim</span>.Ifc4.MeasureResource;
<span class="keyword">using</span> <span class="type">Xbim</span>.Ifc4.ProductExtension;
<span class="keyword">using</span> <span class="type">Xbim</span>.Ifc4.ProfileResource;
<span class="keyword">using</span> <span class="type">Xbim</span>.Ifc4.PropertyResource;
<span class="keyword">using</span> <span class="type">Xbim</span>.Ifc4.QuantityResource;
<span class="keyword">using</span> <span class="type">Xbim</span>.Ifc4.RepresentationResource;
<span class="keyword">using</span> <span class="type">Xbim</span>.Ifc4.SharedBldgElements;
<span class="keyword">using</span> <span class="type">Xbim</span>.IO;


<span class="comment">// we need this to use extension methods in VS 2005</span>


<span class="keyword">namespace</span> <span class="type">HelloWall</span>
{
    <span class="keyword">class</span> <span class="type">Program</span> 
    {
        <span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;summary&gt;</span>
        <span class="xmlDocTag">///</span><span class="xmlDocComment"> This sample demonstrates the minimum steps to create a compliant IFC model that contains a single standard case wall</span>
        <span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;/summary&gt;</span>
        <span class="keyword">static</span> <span class="keyword">int</span> Main()
        {
            <span class="comment">//first create and initialise a model called Hello Wall</span>
            <span class="type">Console</span>.WriteLine(<span class="string">&quot;Initialising the IFC Project....&quot;</span>);
            <span class="keyword">var</span> model = CreateandInitModel(<span class="string">&quot;HelloWall&quot;</span>);
            <span class="keyword">if</span> (model != <span class="keyword">null</span>)
            {
                <span class="type">IfcBuilding</span> building = CreateBuilding(model, <span class="string">&quot;Default Building&quot;</span>);


                <span class="type">IfcWallStandardCase</span> wall = CreateWall(model, 4000, 300, 2400);
                <span class="keyword">if</span> (wall != <span class="keyword">null</span>) AddPropertiesToWall(model, wall);
                <span class="keyword">using</span> (<span class="keyword">var</span> txn = model.BeginTransaction(<span class="string">&quot;Add Wall&quot;</span>))
                {
                    building.AddElement(wall);
                    txn.Commit();
                }

                <span class="keyword">if</span> (wall != <span class="keyword">null</span>)
                {
                    <span class="keyword">try</span>
                    {
                        <span class="type">Console</span>.WriteLine(<span class="string">&quot;Standard Wall successfully created....&quot;</span>);
                        <span class="comment">//write the Ifc File</span>
                        model.SaveAs(<span class="string">&quot;HelloWallIfc4.ifc&quot;</span>,<span class="type">IfcStorageType</span>.Ifc);
                        <span class="type">Console</span>.WriteLine(<span class="string">&quot;HelloWallIfc4.ifc has been successfully written&quot;</span>);
                    }
                    <span class="keyword">catch</span> (<span class="type">Exception</span> e)
                    {
                        <span class="type">Console</span>.WriteLine(<span class="string">&quot;Failed to save HelloWall.ifc&quot;</span>);
                        <span class="type">Console</span>.WriteLine(e.Message);
                    }
                }
            }
            <span class="keyword">else</span>
            {
                <span class="type">Console</span>.WriteLine(<span class="string">&quot;Failed to initialise the model&quot;</span>);
            }

            <span class="type">Console</span>.WriteLine(<span class="string">&quot;Press any key to exit to view the IFC file....&quot;</span>);
            <span class="type">Console</span>.ReadKey();
            LaunchNotepad(<span class="string">&quot;HelloWallIfc4.ifc&quot;</span>);
            <span class="keyword">return</span> 0;
        }

        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> LaunchNotepad(<span class="keyword">string</span> fileName)
        {
            <span class="type">Process</span> p;
            <span class="keyword">try</span>
            {

                p = <span class="keyword">new</span> <span class="type">Process</span> {StartInfo = {FileName = fileName, CreateNoWindow = <span class="keyword">false</span>}};
                p.Start();
            }
            <span class="keyword">catch</span> (<span class="type">Exception</span> ex)
            {
                <span class="type">Console</span>.WriteLine(<span class="string">&quot;Exception Occurred :{0},{1}&quot;</span>,
                          ex.Message, ex.StackTrace);
            }
        }

        <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">IfcBuilding</span> CreateBuilding(<span class="type">IfcStore</span> model, <span class="keyword">string</span> name)
        {
            <span class="keyword">using</span> (<span class="keyword">var</span> txn = model.BeginTransaction(<span class="string">&quot;Create Building&quot;</span>))
            {
                <span class="keyword">var</span> building = model.Instances.New&lt;<span class="type">IfcBuilding</span>&gt;();
                building.Name = name;

                building.CompositionType = <span class="type">IfcElementCompositionEnum</span>.ELEMENT;
                <span class="keyword">var</span> localPlacement = model.Instances.New&lt;<span class="type">IfcLocalPlacement</span>&gt;();                   
                building.ObjectPlacement = localPlacement;
                <span class="keyword">var</span> placement = model.Instances.New&lt;<span class="type">IfcAxis2Placement3D</span>&gt;();
                localPlacement.RelativePlacement = placement;
                placement.Location = model.Instances.New&lt;<span class="type">IfcCartesianPoint</span>&gt;(p=&gt;p.SetXYZ(0,0,0));
                <span class="comment">//get the project there should only be one and it should exist</span>
                <span class="keyword">var</span> project = model.Instances.OfType&lt;<span class="type">IfcProject</span>&gt;().FirstOrDefault();
                project?.AddBuilding(building);
                txn.Commit();
                <span class="keyword">return</span> building;                               
            }          
        }



        <span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;summary&gt;</span>
        <span class="xmlDocTag">///</span><span class="xmlDocComment"> Sets up the basic parameters any model must provide, units, ownership etc</span>
        <span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;/summary&gt;</span>
        <span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;param name=&quot;projectName&quot;&gt;</span><span class="xmlDocComment">Name of the project&lt;/param&gt;</span>
        <span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;returns&gt;</span><span class="xmlDocTag">&lt;/returns&gt;</span>
        <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">IfcStore</span> CreateandInitModel(<span class="keyword">string</span> projectName)
        {
            <span class="comment">//first we need to set up some credentials for ownership of data in the new model</span>
            <span class="keyword">var</span> credentials = <span class="keyword">new</span> <span class="type">XbimEditorCredentials</span>
            {
                ApplicationDevelopersName = <span class="string">&quot;xBimTeam&quot;</span>,
                ApplicationFullName = <span class="string">&quot;Hello Wall Application&quot;</span>,
                ApplicationIdentifier = <span class="string">&quot;HelloWall.exe&quot;</span>,
                ApplicationVersion = <span class="string">&quot;1.0&quot;</span>,
                EditorsFamilyName = <span class="string">&quot;Team&quot;</span>,
                EditorsGivenName = <span class="string">&quot;xBIM&quot;</span>,
                EditorsOrganisationName = <span class="string">&quot;xBimTeam&quot;</span>
            };
            <span class="comment">//now we can create an IfcStore, it is in Ifc4 format and will be held in memory rather than in a database</span>
            <span class="comment">//database is normally better in performance terms if the model is large &gt;50MB of Ifc or if robust transactions are required</span>

            <span class="keyword">var</span> model = <span class="type">IfcStore</span>.Create(credentials, <span class="type">IfcSchemaVersion</span>.Ifc4,<span class="type">XbimStoreType</span>.InMemoryModel);

            <span class="comment">//Begin a transaction as all changes to a model are ACID</span>
            <span class="keyword">using</span> (<span class="keyword">var</span> txn = model.BeginTransaction(<span class="string">&quot;Initialise Model&quot;</span>))
            {

                <span class="comment">//create a project</span>
                <span class="keyword">var</span> project = model.Instances.New&lt;<span class="type">IfcProject</span>&gt;();
                <span class="comment">//set the units to SI (mm and metres)</span>
                project.Initialize(<span class="type">ProjectUnits</span>.SIUnitsUK);
                project.Name = projectName;
                <span class="comment">//now commit the changes, else they will be rolled back at the end of the scope of the using statement</span>
                txn.Commit();
            }
            <span class="keyword">return</span> model; 

        }
        <span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;summary&gt;</span>
        <span class="xmlDocTag">///</span><span class="xmlDocComment"> This creates a wall and it&#39;s geometry, many geometric representations are possible and extruded rectangular footprint is chosen as this is commonly used for standard case walls</span>
        <span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;/summary&gt;</span>
        <span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;param name=&quot;model&quot;&gt;</span><span class="xmlDocTag">&lt;/param&gt;</span>
        <span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;param name=&quot;length&quot;&gt;</span><span class="xmlDocComment">Length of the rectangular footprint&lt;/param&gt;</span>
        <span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;param name=&quot;width&quot;&gt;</span><span class="xmlDocComment">Width of the rectangular footprint (width of the wall)&lt;/param&gt;</span>
        <span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;param name=&quot;height&quot;&gt;</span><span class="xmlDocComment">Height to extrude the wall, extrusion is vertical&lt;/param&gt;</span>
        <span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;returns&gt;</span><span class="xmlDocTag">&lt;/returns&gt;</span>
        <span class="keyword">static</span> <span class="keyword">private</span> <span class="type">IfcWallStandardCase</span> CreateWall(<span class="type">IfcStore</span> model, <span class="keyword">double</span> length, <span class="keyword">double</span> width, <span class="keyword">double</span> height)
        {
            <span class="comment">//</span>
            <span class="comment">//begin a transaction</span>
            <span class="keyword">using</span> (<span class="keyword">var</span> txn = model.BeginTransaction(<span class="string">&quot;Create Wall&quot;</span>))
            {
                <span class="keyword">var</span> wall = model.Instances.New&lt;<span class="type">IfcWallStandardCase</span>&gt;();
                wall.Name = <span class="string">&quot;A Standard rectangular wall&quot;</span>;

                <span class="comment">//represent wall as a rectangular profile</span>
                <span class="keyword">var</span> rectProf = model.Instances.New&lt;<span class="type">IfcRectangleProfileDef</span>&gt;();
                rectProf.ProfileType = <span class="type">IfcProfileTypeEnum</span>.AREA;
                rectProf.XDim = width;
                rectProf.YDim = length;

                <span class="keyword">var</span> insertPoint = model.Instances.New&lt;<span class="type">IfcCartesianPoint</span>&gt;();
                insertPoint.SetXY(0, 400); <span class="comment">//insert at arbitrary position</span>
                rectProf.Position = model.Instances.New&lt;<span class="type">IfcAxis2Placement2D</span>&gt;();
                rectProf.Position.Location = insertPoint;

                <span class="comment">//model as a swept area solid</span>
                <span class="keyword">var</span> body = model.Instances.New&lt;<span class="type">IfcExtrudedAreaSolid</span>&gt;();
                body.Depth = height;
                body.SweptArea = rectProf;
                body.ExtrudedDirection = model.Instances.New&lt;<span class="type">IfcDirection</span>&gt;();
                body.ExtrudedDirection.SetXYZ(0, 0, 1);

                <span class="comment">//parameters to insert the geometry in the model</span>
                <span class="keyword">var</span> origin = model.Instances.New&lt;<span class="type">IfcCartesianPoint</span>&gt;();
                origin.SetXYZ(0, 0, 0);
                body.Position = model.Instances.New&lt;<span class="type">IfcAxis2Placement3D</span>&gt;();
                body.Position.Location = origin;

                <span class="comment">//Create a Definition shape to hold the geometry</span>
                <span class="keyword">var</span> shape = model.Instances.New&lt;<span class="type">IfcShapeRepresentation</span>&gt;();
                <span class="keyword">var</span> modelContext = model.Instances.OfType&lt;<span class="type">IfcGeometricRepresentationContext</span>&gt;().FirstOrDefault();
                shape.ContextOfItems = modelContext;
                shape.RepresentationType = <span class="string">&quot;SweptSolid&quot;</span>;
                shape.RepresentationIdentifier = <span class="string">&quot;Body&quot;</span>;
                shape.Items.Add(body);

                <span class="comment">//Create a Product Definition and add the model geometry to the wall</span>
                <span class="keyword">var</span> rep = model.Instances.New&lt;<span class="type">IfcProductDefinitionShape</span>&gt;();
                rep.Representations.Add(shape);                
                wall.Representation = rep;

                <span class="comment">//now place the wall into the model</span>
                <span class="keyword">var</span> lp = model.Instances.New&lt;<span class="type">IfcLocalPlacement</span>&gt;();
                <span class="keyword">var</span> ax3D = model.Instances.New&lt;<span class="type">IfcAxis2Placement3D</span>&gt;();
                ax3<span class="type">D</span>.Location = origin;
                ax3<span class="type">D</span>.RefDirection = model.Instances.New&lt;<span class="type">IfcDirection</span>&gt;();
                ax3<span class="type">D</span>.RefDirection.SetXYZ(0, 1, 0);
                ax3<span class="type">D</span>.Axis = model.Instances.New&lt;<span class="type">IfcDirection</span>&gt;();
                ax3<span class="type">D</span>.Axis.SetXYZ(0, 0, 1);
                lp.RelativePlacement = ax3<span class="type">D</span>;
                wall.ObjectPlacement = lp;


                <span class="comment">// Where Clause: The IfcWallStandard relies on the provision of an IfcMaterialLayerSetUsage </span>
                <span class="keyword">var</span> ifcMaterialLayerSetUsage = model.Instances.New&lt;<span class="type">IfcMaterialLayerSetUsage</span>&gt;();
                <span class="keyword">var</span> ifcMaterialLayerSet = model.Instances.New&lt;<span class="type">IfcMaterialLayerSet</span>&gt;();
                <span class="keyword">var</span> ifcMaterialLayer = model.Instances.New&lt;<span class="type">IfcMaterialLayer</span>&gt;();
                ifcMaterialLayer.LayerThickness = 10;
                ifcMaterialLayerSet.MaterialLayers.Add(ifcMaterialLayer);
                ifcMaterialLayerSetUsage.ForLayerSet = ifcMaterialLayerSet;
                ifcMaterialLayerSetUsage.LayerSetDirection = <span class="type">IfcLayerSetDirectionEnum</span>.AXIS2;
                ifcMaterialLayerSetUsage.DirectionSense = <span class="type">IfcDirectionSenseEnum</span>.NEGATIVE;
                ifcMaterialLayerSetUsage.OffsetFromReferenceLine = 150;

                <span class="comment">// Add material to wall</span>
                <span class="keyword">var</span> material = model.Instances.New&lt;<span class="type">IfcMaterial</span>&gt;();
                material.Name = <span class="string">&quot;some material&quot;</span>;
                <span class="keyword">var</span> ifcRelAssociatesMaterial = model.Instances.New&lt;<span class="type">IfcRelAssociatesMaterial</span>&gt;();
                ifcRelAssociatesMaterial.RelatingMaterial = material;
                ifcRelAssociatesMaterial.RelatedObjects.Add(wall);

                ifcRelAssociatesMaterial.RelatingMaterial = ifcMaterialLayerSetUsage;

                <span class="comment">// IfcPresentationLayerAssignment is required for CAD presentation in IfcWall or IfcWallStandardCase</span>
                <span class="keyword">var</span> ifcPresentationLayerAssignment = model.Instances.New&lt;<span class="type">IfcPresentationLayerAssignment</span>&gt;();
                ifcPresentationLayerAssignment.Name = <span class="string">&quot;some ifcPresentationLayerAssignment&quot;</span>;
                ifcPresentationLayerAssignment.AssignedItems.Add(shape);


                <span class="comment">// linear segment as IfcPolyline with two points is required for IfcWall</span>
                <span class="keyword">var</span> ifcPolyline = model.Instances.New&lt;<span class="type">IfcPolyline</span>&gt;();
                <span class="keyword">var</span> startPoint = model.Instances.New&lt;<span class="type">IfcCartesianPoint</span>&gt;();
                startPoint.SetXY(0, 0);
                <span class="keyword">var</span> endPoint = model.Instances.New&lt;<span class="type">IfcCartesianPoint</span>&gt;();
                endPoint.SetXY(4000, 0);
                ifcPolyline.Points.Add(startPoint);
                ifcPolyline.Points.Add(endPoint);

                <span class="keyword">var</span> shape2D = model.Instances.New&lt;<span class="type">IfcShapeRepresentation</span>&gt;();
                shape2<span class="type">D</span>.ContextOfItems = modelContext;
                shape2<span class="type">D</span>.RepresentationIdentifier = <span class="string">&quot;Axis&quot;</span>;
                shape2<span class="type">D</span>.RepresentationType = <span class="string">&quot;Curve2D&quot;</span>;
                shape2<span class="type">D</span>.Items.Add(ifcPolyline);
                rep.Representations.Add(shape2<span class="type">D</span>); 
                txn.Commit();               
                <span class="keyword">return</span> wall;
            }

        }

        <span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;summary&gt;</span>
        <span class="xmlDocTag">///</span><span class="xmlDocComment"> Add some properties to the wall,</span>
        <span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;/summary&gt;</span>
        <span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;param name=&quot;model&quot;&gt;</span><span class="xmlDocComment">XbimModel&lt;/param&gt;</span>
        <span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;param name=&quot;wall&quot;&gt;</span><span class="xmlDocTag">&lt;/param&gt;</span>
        <span class="keyword">static</span> <span class="keyword">private</span> <span class="keyword">void</span> AddPropertiesToWall(<span class="type">IfcStore</span> model, <span class="type">IfcWallStandardCase</span> wall)
        {
            <span class="keyword">using</span> (<span class="keyword">var</span> txn = model.BeginTransaction(<span class="string">&quot;Create Wall&quot;</span>))
            {
                CreateElementQuantity(model, wall);
                CreateSimpleProperty(model, wall); 
                txn.Commit(); 
            }
        }

        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> CreateSimpleProperty(<span class="type">IfcStore</span> model, <span class="type">IfcWallStandardCase</span> wall)
        {
            <span class="keyword">var</span> ifcPropertySingleValue = model.Instances.New&lt;<span class="type">IfcPropertySingleValue</span>&gt;(psv =&gt;
            {
                psv.Name = <span class="string">&quot;IfcPropertySingleValue:Time&quot;</span>;
                psv.Description = <span class="string">&quot;&quot;</span>;
                psv.NominalValue = <span class="keyword">new</span> IfcTimeMeasure(150.0);
                psv.Unit = model.Instances.New&lt;<span class="type">IfcSIUnit</span>&gt;(siu =&gt;
                {
                    siu.UnitType = <span class="type">IfcUnitEnum</span>.TIMEUNIT;
                    siu.Name = <span class="type">IfcSIUnitName</span>.SECOND;
                });
            });
            <span class="keyword">var</span> ifcPropertyEnumeratedValue = model.Instances.New&lt;<span class="type">IfcPropertyEnumeratedValue</span>&gt;(pev =&gt;
            {
                pev.Name = <span class="string">&quot;IfcPropertyEnumeratedValue:Music&quot;</span>;
                pev.EnumerationReference = model.Instances.New&lt;<span class="type">IfcPropertyEnumeration</span>&gt;(pe =&gt;
                    {
                        pe.Name = <span class="string">&quot;Notes&quot;</span>;
                        pe.EnumerationValues.Add(<span class="keyword">new</span> IfcLabel(<span class="string">&quot;Do&quot;</span>));
                        pe.EnumerationValues.Add(<span class="keyword">new</span> IfcLabel(<span class="string">&quot;Re&quot;</span>));
                        pe.EnumerationValues.Add(<span class="keyword">new</span> IfcLabel(<span class="string">&quot;Mi&quot;</span>));
                        pe.EnumerationValues.Add(<span class="keyword">new</span> IfcLabel(<span class="string">&quot;Fa&quot;</span>));
                        pe.EnumerationValues.Add(<span class="keyword">new</span> IfcLabel(<span class="string">&quot;So&quot;</span>));
                        pe.EnumerationValues.Add(<span class="keyword">new</span> IfcLabel(<span class="string">&quot;La&quot;</span>));
                        pe.EnumerationValues.Add(<span class="keyword">new</span> IfcLabel(<span class="string">&quot;Ti&quot;</span>));
                    });
                pev.EnumerationValues.Add(<span class="keyword">new</span> IfcLabel(<span class="string">&quot;Do&quot;</span>));
                pev.EnumerationValues.Add(<span class="keyword">new</span> IfcLabel(<span class="string">&quot;Re&quot;</span>));
                pev.EnumerationValues.Add(<span class="keyword">new</span> IfcLabel(<span class="string">&quot;Mi&quot;</span>));

            });
            <span class="keyword">var</span> ifcPropertyBoundedValue = model.Instances.New&lt;<span class="type">IfcPropertyBoundedValue</span>&gt;(pbv =&gt; 
            {
                pbv.Name = <span class="string">&quot;IfcPropertyBoundedValue:Mass&quot;</span>;
                pbv.Description = <span class="string">&quot;&quot;</span>;
                pbv.UpperBoundValue = <span class="keyword">new</span> IfcMassMeasure(5000.0);
                pbv.LowerBoundValue = <span class="keyword">new</span> IfcMassMeasure(1000.0);
                pbv.Unit = model.Instances.New&lt;<span class="type">IfcSIUnit</span>&gt;(siu =&gt;
                {
                    siu.UnitType = <span class="type">IfcUnitEnum</span>.MASSUNIT;
                    siu.Name = <span class="type">IfcSIUnitName</span>.GRAM;
                    siu.Prefix = <span class="type">IfcSIPrefix</span>.KILO;                  
                });
            });

            <span class="keyword">var</span> definingValues = <span class="keyword">new</span> <span class="type">List</span>&lt;<span class="type">IfcReal</span>&gt; { <span class="keyword">new</span> IfcReal(100.0), <span class="keyword">new</span> IfcReal(200.0), <span class="keyword">new</span> IfcReal(400.0), <span class="keyword">new</span> IfcReal(800.0), <span class="keyword">new</span> IfcReal(1600.0), <span class="keyword">new</span> IfcReal(3200.0), };
            <span class="keyword">var</span> definedValues = <span class="keyword">new</span> <span class="type">List</span>&lt;<span class="type">IfcReal</span>&gt; { <span class="keyword">new</span> IfcReal(20.0), <span class="keyword">new</span> IfcReal(42.0), <span class="keyword">new</span> IfcReal(46.0), <span class="keyword">new</span> IfcReal(56.0), <span class="keyword">new</span> IfcReal(60.0), <span class="keyword">new</span> IfcReal(65.0), };
            <span class="keyword">var</span> ifcPropertyTableValue = model.Instances.New&lt;<span class="type">IfcPropertyTableValue</span>&gt;(ptv =&gt;
            {
                ptv.Name = <span class="string">&quot;IfcPropertyTableValue:Sound&quot;</span>;
                <span class="keyword">foreach</span> (<span class="keyword">var</span> item <span class="keyword">in</span> definingValues)
                {
                    ptv.DefiningValues.Add(item);
                }
                <span class="keyword">foreach</span> (<span class="keyword">var</span> item <span class="keyword">in</span> definedValues)
                {
                    ptv.DefinedValues.Add(item);
                }
                ptv.DefinedUnit = model.Instances.New&lt;<span class="type">IfcContextDependentUnit</span>&gt;(cd =&gt;
                {
                    cd.Dimensions = model.Instances.New&lt;<span class="type">IfcDimensionalExponents</span>&gt;(de =&gt;
                    {
                        de.LengthExponent = 0;
                        de.MassExponent = 0;
                        de.TimeExponent = 0;
                        de.ElectricCurrentExponent = 0;
                        de.ThermodynamicTemperatureExponent = 0;
                        de.AmountOfSubstanceExponent = 0;
                        de.LuminousIntensityExponent = 0;
                    });
                    cd.UnitType = <span class="type">IfcUnitEnum</span>.FREQUENCYUNIT;
                    cd.Name = <span class="string">&quot;dB&quot;</span>;
                });


            });

            <span class="keyword">var</span> listValues = <span class="keyword">new</span> <span class="type">List</span>&lt;<span class="type">IfcLabel</span>&gt; { <span class="keyword">new</span> IfcLabel(<span class="string">&quot;Red&quot;</span>), <span class="keyword">new</span> IfcLabel(<span class="string">&quot;Green&quot;</span>), <span class="keyword">new</span> IfcLabel(<span class="string">&quot;Blue&quot;</span>), <span class="keyword">new</span> IfcLabel(<span class="string">&quot;Pink&quot;</span>), <span class="keyword">new</span> IfcLabel(<span class="string">&quot;White&quot;</span>), <span class="keyword">new</span> IfcLabel(<span class="string">&quot;Black&quot;</span>), };
            <span class="keyword">var</span> ifcPropertyListValue = model.Instances.New&lt;<span class="type">IfcPropertyListValue</span>&gt;(plv =&gt;
            {
                plv.Name = <span class="string">&quot;IfcPropertyListValue:Colours&quot;</span>;
                <span class="keyword">foreach</span> (<span class="keyword">var</span> item <span class="keyword">in</span> listValues)
                {
                    plv.ListValues.Add(item);
                }
            });

            <span class="keyword">var</span> ifcMaterial = model.Instances.New&lt;<span class="type">IfcMaterial</span>&gt;(m =&gt;
            {
                m.Name = <span class="string">&quot;Brick&quot;</span>;
            });
            <span class="keyword">var</span> ifcPrValueMaterial = model.Instances.New&lt;<span class="type">IfcPropertyReferenceValue</span>&gt;(prv =&gt;
            {
                prv.Name = <span class="string">&quot;IfcPropertyReferenceValue:Material&quot;</span>;
                prv.PropertyReference = ifcMaterial;
            });


            <span class="keyword">var</span> ifcMaterialList = model.Instances.New&lt;<span class="type">IfcMaterialList</span>&gt;(ml =&gt;
                {
                    ml.Materials.Add(ifcMaterial);
                    ml.Materials.Add(model.Instances.New&lt;<span class="type">IfcMaterial</span>&gt;(m =&gt;{m.Name = <span class="string">&quot;Cavity&quot;</span>;}));
                    ml.Materials.Add(model.Instances.New&lt;<span class="type">IfcMaterial</span>&gt;(m =&gt; { m.Name = <span class="string">&quot;Block&quot;</span>; }));
                });


            <span class="keyword">var</span> ifcMaterialLayer = model.Instances.New&lt;<span class="type">IfcMaterialLayer</span>&gt;(ml =&gt;
            {
                ml.Material = ifcMaterial;
                ml.LayerThickness = 100.0;
            });
            <span class="keyword">var</span> ifcPrValueMatLayer = model.Instances.New&lt;<span class="type">IfcPropertyReferenceValue</span>&gt;(prv =&gt;
            {
                prv.Name = <span class="string">&quot;IfcPropertyReferenceValue:MaterialLayer&quot;</span>;
                prv.PropertyReference = ifcMaterialLayer;
            });

            <span class="keyword">var</span> ifcDocumentReference = model.Instances.New&lt;<span class="type">IfcDocumentReference</span>&gt;(dr =&gt;
            {
                dr.Name = <span class="string">&quot;Document&quot;</span>;
                dr.Location = <span class="string">&quot;c://Documents//TheDoc.Txt&quot;</span>;
            });
            <span class="keyword">var</span> ifcPrValueRef = model.Instances.New&lt;<span class="type">IfcPropertyReferenceValue</span>&gt;(prv =&gt;
            {
                prv.Name = <span class="string">&quot;IfcPropertyReferenceValue:Document&quot;</span>;
                prv.PropertyReference = ifcDocumentReference;
            });

            <span class="keyword">var</span> ifcTimeSeries = model.Instances.New&lt;<span class="type">IfcRegularTimeSeries</span>&gt;(ts =&gt;
            {
                ts.Name = <span class="string">&quot;Regular Time Series&quot;</span>;
                ts.Description = <span class="string">&quot;Time series of events&quot;</span>;
                ts.StartTime = <span class="keyword">new</span> IfcDateTime(<span class="string">&quot;2015-02-14T12:01:01&quot;</span>);
                ts.EndTime = <span class="keyword">new</span> IfcDateTime(<span class="string">&quot;2015-05-15T12:01:01&quot;</span>);
                ts.TimeSeriesDataType = <span class="type">IfcTimeSeriesDataTypeEnum</span>.CONTINUOUS;
                ts.DataOrigin = <span class="type">IfcDataOriginEnum</span>.MEASURED;
                ts.TimeStep = 604800; <span class="comment">//7 days in secs</span>
            });

            <span class="keyword">var</span> ifcPrValueTimeSeries = model.Instances.New&lt;<span class="type">IfcPropertyReferenceValue</span>&gt;(prv =&gt;
            {
                prv.Name = <span class="string">&quot;IfcPropertyReferenceValue:TimeSeries&quot;</span>;
                prv.PropertyReference = ifcTimeSeries;
            });

            <span class="keyword">var</span> ifcAddress = model.Instances.New&lt;<span class="type">IfcPostalAddress</span>&gt;(a =&gt;
            {
                a.InternalLocation = <span class="string">&quot;Room 101&quot;</span>;
                a.AddressLines.AddRange(<span class="keyword">new</span>[] { <span class="keyword">new</span> IfcLabel(<span class="string">&quot;12 New road&quot;</span>), <span class="keyword">new</span> IfcLabel(<span class="string">&quot;DoxField&quot;</span> ) });
                a.Town = <span class="string">&quot;Sunderland&quot;</span>;
                a.PostalCode = <span class="string">&quot;DL01 6SX&quot;</span>;
            });
            <span class="keyword">var</span> ifcPrValueAddress = model.Instances.New&lt;<span class="type">IfcPropertyReferenceValue</span>&gt;(prv =&gt;
            {
                prv.Name = <span class="string">&quot;IfcPropertyReferenceValue:Address&quot;</span>;
                prv.PropertyReference = ifcAddress;
            });
            <span class="keyword">var</span> ifcTelecomAddress = model.Instances.New&lt;<span class="type">IfcTelecomAddress</span>&gt;(a =&gt;
            {
                a.TelephoneNumbers.Add(<span class="keyword">new</span> IfcLabel(<span class="string">&quot;01325 6589965&quot;</span>));
                a.ElectronicMailAddresses.Add(<span class="keyword">new</span> IfcLabel(<span class="string">&quot;bob@bobsworks.com&quot;</span>));
            });
            <span class="keyword">var</span> ifcPrValueTelecom = model.Instances.New&lt;<span class="type">IfcPropertyReferenceValue</span>&gt;(prv =&gt;
            {
                prv.Name = <span class="string">&quot;IfcPropertyReferenceValue:Telecom&quot;</span>;
                prv.PropertyReference = ifcTelecomAddress;
            });



            <span class="comment">//lets create the IfcElementQuantity</span>
            <span class="keyword">var</span> ifcPropertySet = model.Instances.New&lt;<span class="type">IfcPropertySet</span>&gt;(ps =&gt;
            {              
                ps.Name = <span class="string">&quot;Test:IfcPropertySet&quot;</span>;
                ps.Description = <span class="string">&quot;Property Set&quot;</span>;
                ps.HasProperties.Add(ifcPropertySingleValue);
                ps.HasProperties.Add(ifcPropertyEnumeratedValue);
                ps.HasProperties.Add(ifcPropertyBoundedValue);
                ps.HasProperties.Add(ifcPropertyTableValue);
                ps.HasProperties.Add(ifcPropertyListValue);
                ps.HasProperties.Add(ifcPrValueMaterial);
                ps.HasProperties.Add(ifcPrValueMatLayer);
                ps.HasProperties.Add(ifcPrValueRef);
                ps.HasProperties.Add(ifcPrValueTimeSeries);
                ps.HasProperties.Add(ifcPrValueAddress);
                ps.HasProperties.Add(ifcPrValueTelecom);             
            });

            <span class="comment">//need to create the relationship</span>
            model.Instances.New&lt;<span class="type">IfcRelDefinesByProperties</span>&gt;(rdbp =&gt;
            {                
                rdbp.Name = <span class="string">&quot;Property Association&quot;</span>;
                rdbp.Description = <span class="string">&quot;IfcPropertySet associated to wall&quot;</span>;
                rdbp.RelatedObjects.Add(wall);
                rdbp.RelatingPropertyDefinition = ifcPropertySet;
            });
        }

        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> CreateElementQuantity(<span class="type">IfcStore</span> model, <span class="type">IfcWallStandardCase</span> wall)
        {
            <span class="comment">//Create a IfcElementQuantity</span>
            <span class="comment">//first we need a IfcPhysicalSimpleQuantity,first will use IfcQuantityLength</span>
            <span class="keyword">var</span> ifcQuantityArea = model.Instances.New&lt;<span class="type">IfcQuantityLength</span>&gt;(qa =&gt;
            {
                qa.Name = <span class="string">&quot;IfcQuantityArea:Area&quot;</span>;
                qa.Description = <span class="string">&quot;&quot;</span>;
                qa.Unit = model.Instances.New&lt;<span class="type">IfcSIUnit</span>&gt;(siu =&gt;
                {
                    siu.UnitType = <span class="type">IfcUnitEnum</span>.LENGTHUNIT;
                    siu.Prefix = <span class="type">IfcSIPrefix</span>.MILLI;
                    siu.Name = <span class="type">IfcSIUnitName</span>.METRE;
                });
                qa.LengthValue = 100.0;

            });
            <span class="comment">//next quantity IfcQuantityCount using IfcContextDependentUnit</span>
            <span class="keyword">var</span> ifcContextDependentUnit = model.Instances.New&lt;<span class="type">IfcContextDependentUnit</span>&gt;(cd =&gt;
                {
                    cd.Dimensions = model.Instances.New&lt;<span class="type">IfcDimensionalExponents</span>&gt;(de =&gt;
                        {
                            de.LengthExponent = 1;
                            de.MassExponent = 0;
                            de.TimeExponent = 0;
                            de.ElectricCurrentExponent = 0;
                            de.ThermodynamicTemperatureExponent = 0;
                            de.AmountOfSubstanceExponent = 0;
                            de.LuminousIntensityExponent = 0;
                        });
                    cd.UnitType = <span class="type">IfcUnitEnum</span>.LENGTHUNIT;
                    cd.Name = <span class="string">&quot;Elephants&quot;</span>;
                });
                <span class="keyword">var</span> ifcQuantityCount = model.Instances.New&lt;<span class="type">IfcQuantityCount</span>&gt;(qc =&gt;
                {
                    qc.Name = <span class="string">&quot;IfcQuantityCount:Elephant&quot;</span>;
                    qc.CountValue = 12;
                    qc.Unit = ifcContextDependentUnit;
                });


             <span class="comment">//next quantity IfcQuantityLength using IfcConversionBasedUnit</span>
            <span class="keyword">var</span> ifcConversionBasedUnit = model.Instances.New&lt;<span class="type">IfcConversionBasedUnit</span>&gt;(cbu =&gt;
            {
                cbu.ConversionFactor = model.Instances.New&lt;<span class="type">IfcMeasureWithUnit</span>&gt;(mu =&gt;
                {
                    mu.ValueComponent = <span class="keyword">new</span> IfcRatioMeasure(25.4);
                    mu.UnitComponent = model.Instances.New&lt;<span class="type">IfcSIUnit</span>&gt;(siu =&gt;
                    {
                        siu.UnitType = <span class="type">IfcUnitEnum</span>.LENGTHUNIT;
                        siu.Prefix = <span class="type">IfcSIPrefix</span>.MILLI;
                        siu.Name = <span class="type">IfcSIUnitName</span>.METRE;
                    });

                });
                cbu.Dimensions = model.Instances.New&lt;<span class="type">IfcDimensionalExponents</span>&gt;(de =&gt;
                {
                    de.LengthExponent = 1;
                    de.MassExponent = 0;
                    de.TimeExponent = 0;
                    de.ElectricCurrentExponent = 0;
                    de.ThermodynamicTemperatureExponent = 0;
                    de.AmountOfSubstanceExponent = 0;
                    de.LuminousIntensityExponent = 0;
                });
                cbu.UnitType = <span class="type">IfcUnitEnum</span>.LENGTHUNIT;
                cbu.Name = <span class="string">&quot;Inch&quot;</span>;
            });
            <span class="keyword">var</span> ifcQuantityLength = model.Instances.New&lt;<span class="type">IfcQuantityLength</span>&gt;(qa =&gt;
            {
                qa.Name = <span class="string">&quot;IfcQuantityLength:Length&quot;</span>;
                qa.Description = <span class="string">&quot;&quot;</span>;
                qa.Unit = ifcConversionBasedUnit;
                qa.LengthValue = 24.0;
            });

            <span class="comment">//lets create the IfcElementQuantity</span>
            <span class="keyword">var</span> ifcElementQuantity = model.Instances.New&lt;<span class="type">IfcElementQuantity</span>&gt;(eq =&gt;
            {               
                eq.Name = <span class="string">&quot;Test:IfcElementQuantity&quot;</span>;
                eq.Description = <span class="string">&quot;Measurement quantity&quot;</span>;
                eq.Quantities.Add(ifcQuantityArea);
                eq.Quantities.Add(ifcQuantityCount);
                eq.Quantities.Add(ifcQuantityLength);
            });

            <span class="comment">//need to create the relationship</span>
            model.Instances.New&lt;<span class="type">IfcRelDefinesByProperties</span>&gt;(rdbp =&gt;
            {              
                rdbp.Name = <span class="string">&quot;Area Association&quot;</span>;
                rdbp.Description = <span class="string">&quot;IfcElementQuantity associated to wall&quot;</span>;
                rdbp.RelatedObjects.Add(wall);
                rdbp.RelatingPropertyDefinition = ifcElementQuantity;
            });
        }



    }
}
</code></pre></div>

    </div>
	    


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>
  </body>
</html>
